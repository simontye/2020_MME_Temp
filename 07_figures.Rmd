---
title: "figures"
author: "fishkill friends"
date: "2020/01/05"
output: github_document
---

### Step 1: Load packages and data

This is a second pass at data processing to prepare data for model fitting.

```{r: Load packages and data}
# Load packages
library(tidyverse)
library(caret)
library(dplyr)

# Reset global environment
rm(list = ls())

# Change working directory
setwd("/Users/simontye/Documents/Research/Projects/MME_Temp/2020_MME_Temp/data/processed")

# Load historical data
df.historical <- read.csv(file = "df_historical.csv", head = TRUE, sep = ",")
#df.future     <- read.csv(file = "df_future.csv", head = TRUE, sep = ",")
```

### Step 2: Preliminary figures

This creates some basic figures that compare summerkill events with thermal extremes, as well as compare thermal extremes with geographic variables to determine grouping patterns of thermal regimes.

```{r: Preliminary figures}
# Create theme
pretty <- theme_classic(base_size = 12) +
  theme(axis.title.y      = element_text(margin = margin(r = 20)),
        axis.title.x      = element_text(margin = margin(t = 20)), 
        axis.text         = element_text(color = "black"), 
        axis.ticks        = element_line(color = "black"),
        axis.ticks.length = unit(.25, "cm"), 
        legend.key.size   = unit(1.5,  'lines'),
        legend.position   = "right")

# Subset states
mn <- subset(df.historical, state == "minnesota")
wi <- subset(df.historical, state == "wisconsin")

# Subset fishkills
no  <- subset(df.historical, summerkill == "0")
yes <- subset(df.historical, summerkill == "1")

# Subset ecoregions
e.46 <- subset(df.historical, l3_code == "46")
e.48 <- subset(df.historical, l3_code == "48")
e.50 <- subset(df.historical, l3_code == "50")
e.52 <- subset(df.historical, l3_code == "52")
e.54 <- subset(df.historical, l3_code == "54")

# Max surface water temperature by month
ggplot() +
  geom_point(df.historical, mapping = aes(x = month, y = max_surf, color = season), size = 0.05) +
  labs(y = "Max surface water temperature (ºC)", x = "Month") +
  pretty

# Max bottom water temperature by month
ggplot() +
  geom_point(df.historical, mapping = aes(x = month, y = max_surf, color = season), size = 0.05) +
  labs(y = "Max bottom water temperature (ºC)", x = "Month") +
  pretty

# Fishkills by maximum surface water and air temperature (colored by presence)
ggplot() +
  geom_point(no, mapping = aes(x = max_surf, y = max_air), size = 0.05, color = "lightblue") +
  geom_point(yes,  mapping = aes(x = max_surf, y = max_air, color = l3_code), size = 2) +
  labs(y = "Max air temperature (ºC)", x = "Max surface water temperature (ºC)") +
  pretty

# Fishkills by maximum surface water and air temperature (colored by state)
ggplot() +
  geom_point(no, mapping = aes(x = max_surf, y = max_air), size = 0.05, color = "lightblue") +
  geom_point(yes,  mapping = aes(x = max_surf, y = max_air, color = state), size = 2) +
  labs(y = "Max air temperature (ºC)", x = "Max surface water temperature (ºC)") +
  pretty

# Fishkills by maximum surface water and air temperature (colored by season)
ggplot() +
  geom_point(no, mapping = aes(x = max_surf, y = max_air), size = 0.05, color = "lightblue") +
  geom_point(yes,  mapping = aes(x = max_surf, y = max_air, color = season), size = 2) +
  labs(y = "Max air temperature (ºC)", x = "Max surface water temperature (ºC)") +
  pretty

# Fishkills by maximum surface water and air temperature (colored by month)
ggplot() +
  geom_point(no, mapping = aes(x = max_surf, y = max_air), size = 0.05, color = "lightblue") +
  geom_point(yes,  mapping = aes(x = max_surf, y = max_air, color = month), size = 2) +
  labs(y = "Max air temperature (ºC)", x = "Max surface water temperature (ºC)") +
  guides(colour = guide_legend(override.aes = list(size = 1.5))) +
  pretty

# Maximum surface water and air temperature (colored by season)
ggplot() +
  geom_point(df.historical, mapping = aes(x = max_surf, y = max_air, color = season), size = 0.05) +
  labs(y = "Max air temperature (ºC)", x = "Max surface water temperature (ºC)") +
  guides(colour = guide_legend(override.aes = list(size = 1.5))) +
  pretty

# Maximum surface water and air temperature (colored by ecoregion)
ggplot() +
  geom_point(e.46, mapping = aes(x = max_surf, y = max_air, color = l3_code), size = 0.02) +
  labs(y = "Max air temperature (ºC)", x = "Max surface water temperature (ºC)") +
  guides(colour = guide_legend(override.aes = list(size = 1.5))) +
  pretty
```
